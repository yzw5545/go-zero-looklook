# 依赖安装总结

> 生成时间：2025-12-13
> 检测系统：macOS 14.1.1 - Apple M2 Pro - 32GB RAM

---

## ✅ 系统环境检测结果

### 硬件配置

| 项目 | 配置 | 状态 |
|------|------|------|
| CPU | Apple M2 Pro (10核) | ✅ 优秀 |
| 内存 | 32 GB | ✅ 充足 |
| 可用磁盘 | 599 GB | ✅ 充足 |
| 架构 | ARM64 (Apple Silicon) | ✅ 支持 |

**您的系统配置完全满足运行 go-zero-looklook 的要求！** 👍

---

## 📦 依赖安装状态

### 核心依赖

| 依赖 | 状态 | 当前版本 | 所需版本 | 说明 |
|------|------|----------|----------|------|
| ✅ Docker | **已安装** | 28.4.0 | >= 20.10 | 容器运行环境 |
| ✅ Docker Compose | **已安装** | v2.39.2 | >= 2.0 | 容器编排工具 |
| ✅ Go | **已安装** | 1.20.2 | >= 1.17.7 | Go 语言环境 |
| ✅ Git | **已安装** | 2.39.3 | >= 2.0 | 版本控制 |
| ✅ Make | **已安装** | 3.81 | >= 3.8 | 构建工具 |
| ✅ Protobuf (protoc) | **已安装** | 32.1 | >= 3.0 | Protocol Buffers 编译器 |
| ✅ Homebrew | **已安装** | 5.0.3 | 最新 | macOS 包管理器 |

### 开发工具（需要安装）

| 依赖 | 状态 | 推荐版本 | 用途 |
|------|------|----------|------|
| ❌ goctl | **未安装** | 最新版 | go-zero 代码生成工具 ⭐⭐⭐⭐⭐ |
| ❌ modd | **未安装** | 最新版 | 热加载开发工具 ⭐⭐⭐⭐ |
| ❌ protoc-gen-go | **未安装** | >= 1.26 | Protobuf Go 代码生成 ⭐⭐⭐⭐⭐ |
| ❌ protoc-gen-go-grpc | **未安装** | >= 1.1 | gRPC Go 代码生成 ⭐⭐⭐⭐⭐ |

---

## 🚀 快速安装

### 方式一：自动安装脚本（推荐）

```bash
cd /Users/yzw/Documents/study/go-zero-looklook
./setup.sh
```

这个脚本会自动安装所有缺失的依赖！

### 方式二：手动安装

```bash
# 1. 安装 goctl
brew install goctl
# 或
go install github.com/zeromicro/go-zero/tools/goctl@latest

# 2. 安装 modd
brew install modd

# 3. 安装 protoc-gen-go
go install google.golang.org/protobuf/cmd/protoc-gen-go@latest

# 4. 安装 protoc-gen-go-grpc
go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@latest

# 5. 配置环境变量
echo 'export PATH=$PATH:$HOME/go/bin' >> ~/.zshrc
source ~/.zshrc
```

---

## 📋 安装步骤详解

### 第一步：运行自动安装

```bash
cd /Users/yzw/Documents/study/go-zero-looklook
chmod +x setup.sh
./setup.sh
```

**脚本会自动完成：**
- ✅ 检测系统环境
- ✅ 检查并启动 Docker
- ✅ 配置 Go 环境变量和代理
- ✅ 安装 goctl、modd
- ✅ 安装 Protobuf 工具链
- ✅ 下载项目 Go 依赖
- ✅ 创建快速启动脚本

### 第二步：重新加载 Shell 配置

```bash
source ~/.zshrc
```

### 第三步：启动项目

```bash
./start.sh
```

---

## 🎯 运行项目的三种方式

### 1. 使用自动脚本（最简单）

```bash
# 启动所有服务
./start.sh

# 停止所有服务
./stop.sh
```

### 2. 使用 Docker Compose

```bash
# 启动中间件
docker compose -f docker-compose-env.yml up -d

# 启动应用
docker compose up -d

# 停止服务
docker compose down
docker compose -f docker-compose-env.yml down
```

### 3. 使用 modd 热加载（开发推荐）

```bash
# 启动中间件
docker compose -f docker-compose-env.yml up -d

# 使用 modd 运行（支持热加载）
modd
```

---

## 📊 项目服务访问地址

启动后可以访问以下服务：

| 服务名称 | 访问地址 | 用途 |
|---------|---------|------|
| **Nginx 网关** | http://localhost:8888 | API 统一入口 |
| **Prometheus** | http://localhost:9090 | 监控指标查询 |
| **Grafana** | http://localhost:3001 | 监控可视化面板 |
| **Jaeger** | http://localhost:16686 | 分布式链路追踪 |
| **Kibana** | http://localhost:5601 | 日志查询和分析 |
| **asynqmon** | http://localhost:8980 | 异步任务队列管理 |
| **Elasticsearch** | http://localhost:9200 | 日志存储（API） |

### API 路由规则

通过 Nginx 网关访问各服务：

- `http://localhost:8888/usercenter/*` → 用户中心服务
- `http://localhost:8888/order/*` → 订单服务
- `http://localhost:8888/payment/*` → 支付服务
- `http://localhost:8888/travel/*` → 旅游/民宿服务

---

## 🧪 快速测试

### 测试 1: 检查服务状态

```bash
docker compose ps
```

### 测试 2: 用户注册

```bash
curl -X POST http://localhost:8888/usercenter/v1/user/register \
  -H "Content-Type: application/json" \
  -d '{
    "mobile": "13800138000",
    "password": "123456"
  }' | jq
```

### 测试 3: 用户登录

```bash
curl -X POST http://localhost:8888/usercenter/v1/user/login \
  -H "Content-Type: application/json" \
  -d '{
    "authType": "mobile",
    "authKey": "13800138000",
    "password": "123456"
  }' | jq
```

### 测试 4: 访问监控面板

在浏览器中访问：
- Grafana: http://localhost:3001
- Jaeger: http://localhost:16686

---

## 📚 相关文档

已为您生成以下文档：

| 文档 | 说明 | 路径 |
|------|------|------|
| **INSTALLATION_GUIDE.md** | 完整安装指南（40+ 页） | 根目录 |
| **QUICKSTART.md** | 快速开始指南 | 根目录 |
| **CLAUDE.md** | 项目开发指南 | 根目录 |
| **setup.sh** | 自动安装脚本 | 根目录 |
| **start.sh** | 快速启动脚本 | 根目录（setup.sh 生成）|
| **stop.sh** | 快速停止脚本 | 根目录（setup.sh 生成）|

---

## ⚠️ 注意事项

### Docker 相关

1. **Docker Desktop 必须运行**
   ```bash
   # 启动 Docker Desktop
   open -a Docker

   # 验证是否运行
   docker info
   ```

2. **首次启动较慢**
   - 需要下载 Docker 镜像（约 5-10 GB）
   - 等待时间：5-10 分钟

3. **内存分配**
   - 推荐为 Docker Desktop 分配至少 8GB 内存
   - 设置路径：Docker Desktop → Settings → Resources → Memory

### 端口占用

确保以下端口未被占用：
- 8888 (Nginx)
- 3306 (MySQL)
- 6379 (Redis)
- 9092 (Kafka)
- 9200 (Elasticsearch)
- 其他监控服务端口

检查端口：
```bash
lsof -i :8888
```

### 环境变量

安装后需要重新加载 Shell 配置：
```bash
source ~/.zshrc  # zsh
# 或
source ~/.bash_profile  # bash
```

---

## 🔧 常见问题速查

### 问题：goctl 命令找不到

```bash
# 确保 GOPATH/bin 在 PATH 中
export PATH=$PATH:$HOME/go/bin
echo 'export PATH=$PATH:$HOME/go/bin' >> ~/.zshrc
source ~/.zshrc
```

### 问题：Docker 容器无法启动

```bash
# 查看日志
docker compose logs [service-name]

# 重新启动
docker compose restart [service-name]
```

### 问题：Go 依赖下载慢

```bash
# 设置国内代理
go env -w GOPROXY=https://goproxy.cn,direct

# 重新下载
go mod download
```

### 问题：Elasticsearch 启动失败

```bash
# 降低内存占用
# 编辑 docker-compose-env.yml
ES_JAVA_OPTS: "-Xms512m -Xmx512m"
```

---

## 📞 获取帮助

如果遇到问题：

1. **查看详细文档**
   - INSTALLATION_GUIDE.md（完整指南）
   - 常见问题章节

2. **检查日志**
   ```bash
   docker compose logs -f
   ```

3. **社区支持**
   - go-zero 官方社区
   - GitHub Issues

4. **官方资源**
   - go-zero 官网: https://go-zero.dev/
   - 视频教程: https://space.bilibili.com/389552232/video

---

## 🎉 总结

### 您的系统状态

✅ **7/11 依赖已安装** (64%)

### 还需安装

- goctl（强烈推荐）
- modd（推荐）
- protoc-gen-go（强烈推荐）
- protoc-gen-go-grpc（强烈推荐）

### 推荐操作

```bash
# 运行自动安装脚本（一键安装所有依赖）
./setup.sh

# 重新加载 shell 配置
source ~/.zshrc

# 启动项目
./start.sh
```

---

**祝您使用愉快！如有问题随时查阅文档。** 🚀
